{"version":3,"file":"FontAwesomePicker.js","sources":["../../../components/fontawesome/FontAwesomePicker.js"],"sourcesContent":["import classnames from 'classnames';\nimport { element } from 'wp';\nimport { faPalette } from '@fortawesome/free-solid-svg-icons';\nimport debounce from 'lodash-es/debounce';\n\nimport { getFontAwesomeList } from './util';\nimport { CloseButton } from './components/CloseButton';\nimport { Controls } from './components/Controls';\nimport { FontAwesomeIcon } from './FontAwesomeIcon';\n\nconst { Component } = element;\n\nclass FontAwesomePickerComponent extends Component {\n    constructor(props) {\n        super(props);\n\n        this.timer = null;\n\n        this.onSearch = debounce(this.onSearch, 600).bind(this);\n\n        this.hideList = this.hideList.bind(this);\n        this.showList = this.showList.bind(this);\n        this.toggleList = this.toggleList.bind(this);\n\n        this.state = {\n            listElementRendered: false,\n            listElementVisible: false,\n            isSearchActive: false,\n            search: '',\n            results: [],\n            iconsByName: {},\n            iconList: [],\n        };\n    }\n\n    componentDidMount() {\n        this.initIcons();\n    }\n\n    hideList() {\n        if (this.timer) {\n            clearTimeout(this.timer);\n        }\n        this.setState({\n            listElementVisible: false,\n        });\n        this.timer = setTimeout(() => {\n            this.setState({\n                listElementRendered: false,\n            });\n            this.timer = null;\n        }, 1000);\n    }\n\n    initIcons() {\n        const { iconsByName, list: iconList } = getFontAwesomeList();\n\n        this.setState({\n            iconsByName,\n            iconList,\n        });\n    }\n\n    isValidIcon(icon) {\n        return Boolean(\n            icon && icon.iconName && this.state.iconsByName[icon.iconName]\n        );\n    }\n\n    onSearch(needle) {\n        if (!needle) {\n            this.setState({ isSearchActive: false, results: [] });\n        } else {\n            const regex = new RegExp(`${needle}`);\n            const results = this.state.iconList.filter((iconObject) =>\n                regex.test(iconObject.definition.iconName)\n            );\n            this.setState({ results, isSearchActive: true });\n        }\n    }\n\n    showList() {\n        if (this.timer) {\n            clearTimeout(this.timer);\n        }\n        this.setState({\n            listElementRendered: true,\n        });\n        this.timer = setTimeout(() => {\n            this.setState({\n                listElementVisible: true,\n            });\n            this.timer = null;\n        }, 50);\n    }\n\n    toggleList() {\n        if (this.state.listElementRendered) {\n            this.hideList();\n        } else {\n            this.showList();\n        }\n    }\n\n    render() {\n        const { icon = null, onChange = () => {} } = this.props;\n        const {\n            iconList,\n            isSearchActive,\n            listElementRendered,\n            listElementVisible,\n            results,\n            search,\n        } = this.state;\n\n        const isValidIcon = this.isValidIcon(icon);\n        const _icon = isValidIcon ? icon : faPalette;\n        const listShown = isSearchActive ? results : iconList;\n\n        return (\n            <div className=\"ghwp-fontawesome-picker\">\n                <FontAwesomeIcon\n                    className={classnames({\n                        'ghwp-fontawesome-picker__button': !isValidIcon,\n                        'ghwp-fontawesome-picker__icon': isValidIcon,\n                        'is-active': listElementRendered,\n                    })}\n                    icon={_icon}\n                    large\n                    onClick={this.toggleList}\n                />\n                {listElementRendered && (\n                    <div\n                        className={classnames({\n                            'ghwp-fontawesome-picker__popup': true,\n                            'is-hidden': !listElementVisible,\n                        })}\n                    >\n                        <Controls\n                            value={search}\n                            onChange={(search) => {\n                                this.setState({ search });\n                                this.onSearch(search);\n                            }}\n                            onClick={() => {\n                                this.setState({\n                                    results: [],\n                                    search: '',\n                                    isSearchActive: false,\n                                });\n                                this.hideList();\n                                onChange(null);\n                            }}\n                        />\n                        <CloseButton onClick={this.hideList} />\n                        {/*                 ICONS LIST                       */}\n                        <div className=\"ghwp-fontawesome-picker__list\">\n                            {listShown.map((iconObject, i) => (\n                                <span\n                                    key={i}\n                                    className={classnames([\n                                        'ghwp-fontawesome-picker__item',\n                                        {\n                                            'is-active':\n                                                _icon &&\n                                                _icon.iconName ===\n                                                    iconObject.definition\n                                                        .iconName,\n                                        },\n                                    ])}\n                                    dangerouslySetInnerHTML={{\n                                        __html: iconObject.html,\n                                    }}\n                                    onClick={() => {\n                                        onChange(iconObject.definition);\n                                        this.hideList();\n                                    }}\n                                />\n                            ))}\n                        </div>\n                    </div>\n                )}\n            </div>\n        );\n    }\n}\n\nexport const FontAwesomePicker = FontAwesomePickerComponent;\n"],"names":["Component","element","FontAwesomePickerComponent","props","timer","onSearch","debounce","bind","hideList","showList","toggleList","state","listElementRendered","listElementVisible","isSearchActive","search","results","iconsByName","iconList","initIcons","clearTimeout","setState","setTimeout","getFontAwesomeList","list","icon","Boolean","iconName","needle","regex","RegExp","filter","iconObject","test","definition","onChange","isValidIcon","_icon","faPalette","listShown","classnames","map","i","__html","html","FontAwesomePicker"],"mappings":"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"}