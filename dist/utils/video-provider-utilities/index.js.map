{"version":3,"file":"index.js","sources":["../../../utils/video-provider-utilities/index.js"],"sourcesContent":["import { data } from 'wp';\n\nconst { dispatch } = data;\n// prettier-ignore\nconst YT_LONG_REGEX = /https?:\\/\\/(?:www\\.)?youtube\\.com\\/watch\\?(?:[^\\s&?]*)*(?:&?v=([^&?\\s]*))(?:&[^\\s&?]*)*/;\nconst YT_SHORT_REGEX = /https?:\\/\\/youtu\\.be\\/([^\\s&?]*)/;\n// prettier-ignore\nconst YT_EMBED_REGEX = /https?:\\/\\/(?:www\\.)?youtube\\.com\\/embed\\/(?:([^&?\\s]*))(?:&[^\\s&?]*)*/;\nconst VIMEO_REGEX = /https?:\\/\\/(?:www\\.)?vimeo\\.com\\/(\\d*)(?:(?:&|\\?|\\/)?.*)*/;\n// prettier-ignore\nconst VIMEO_EMBED_REGEX = /https?:\\/\\/(?:www\\.)?player\\.vimeo\\.com\\/video\\/(?:([^&?\\s]*))(?:&[^\\s&?]*)*/;\nconst IFRAME_REGEX = /<iframe.*src=\"([^\"]*)\".*><\\/iframe>/;\n\nexport const getYoutubeEmbedUrlFromVideoId = (videoId) => {\n    return `https://www.youtube.com/embed/${videoId}`;\n};\n\nexport const getVimeoEmbedUrlFromVideoId = (videoId) => {\n    return `https://player.vimeo.com/video/${videoId}`;\n};\n\nconst isLongYoutubeUrl = (videoUrl) => videoUrl.match(YT_LONG_REGEX);\nconst isShortYoutubeUrl = (videoUrl) => videoUrl.match(YT_SHORT_REGEX);\nconst isEmbedYoutubeUrl = (videoUrl) => videoUrl.match(YT_EMBED_REGEX);\nconst isDefaultVimeoUrl = (videoUrl) => videoUrl.match(VIMEO_REGEX);\nconst isEmbedVimeoUrl = (videoUrl) => videoUrl.match(VIMEO_EMBED_REGEX);\nconst isIframeString = (videoUrl) => videoUrl.match(IFRAME_REGEX);\n\n/*\n ******************************************************************************\n *   Test URLs                                                                *\n ******************************************************************************/\n\nexport const isYoutubeUrl = (videoUrl) => {\n    return !!(\n        isLongYoutubeUrl(videoUrl) ||\n        isShortYoutubeUrl(videoUrl) ||\n        isEmbedYoutubeUrl(videoUrl)\n    );\n};\n\nexport const isVimeoUrl = (videoUrl) => {\n    return !!(isDefaultVimeoUrl(videoUrl) || isEmbedVimeoUrl(videoUrl));\n};\n\n/*\n ******************************************************************************\n *   IDs from URLs                                                            *\n ******************************************************************************/\n\nexport const getYoutubeVideoIdFromUrl = (videoUrl) => {\n    const isYT = isLongYoutubeUrl(videoUrl);\n    const isShortYT = isShortYoutubeUrl(videoUrl);\n    const isEmbedYT = isEmbedYoutubeUrl(videoUrl);\n    if (isYT && isYT[1]) {\n        return isYT[1];\n    } else if (isShortYT && isShortYT[1]) {\n        return isShortYT[1];\n    } else if (isEmbedYT && isEmbedYT[1]) {\n        return isEmbedYT[1];\n    } else {\n        return null;\n    }\n};\n\nexport const getVimeoVideoIdFromUrl = (videoUrl) => {\n    const isVimeo = isDefaultVimeoUrl(videoUrl);\n    const isEmbedVimeo = isEmbedVimeoUrl(videoUrl);\n    if (isVimeo && isVimeo[1]) {\n        return isVimeo[1];\n    } else if (isEmbedVimeo && isEmbedVimeo[1]) {\n        return isEmbedVimeo[1];\n    } else {\n        return null;\n    }\n};\n\n/*\n ******************************************************************************\n *   PrÃªt-a-manger embed urls                                                 *\n ******************************************************************************/\n\nexport const getYoutubeEmbedByUrl = (videoUrl) => {\n    if (!isYoutubeUrl(videoUrl)) return null;\n    else if (isEmbedYoutubeUrl(videoUrl)) return videoUrl;\n\n    const videoId = getYoutubeVideoIdFromUrl(videoUrl);\n    return getYoutubeEmbedUrlFromVideoId(videoId);\n};\n\nexport const getVimeoEmbedByUrl = (videoUrl) => {\n    if (!isVimeoUrl(videoUrl)) return null;\n    else if (isEmbedVimeoUrl(videoUrl)) return videoUrl;\n\n    const videoId = getVimeoVideoIdFromUrl(videoUrl);\n    return getVimeoEmbedUrlFromVideoId(videoId);\n};\n\n/*\n ******************************************************************************\n *   Full service embed URL generator                                         *\n ******************************************************************************/\n\nexport const getVideoEmbed = (videoUrl) => {\n    const isIframe = isIframeString(videoUrl);\n    if (isIframe && isIframe[1]) {\n        return isIframe[1];\n    }\n\n    if (isYoutubeUrl(videoUrl)) return getYoutubeEmbedByUrl(videoUrl);\n    if (isVimeoUrl(videoUrl)) return getVimeoEmbedByUrl(videoUrl);\n\n    return videoUrl;\n};\n\n/*\n ******************************************************************************\n *   Bonus: Thumbnails                                                        *\n ******************************************************************************/\n\nexport const getYoutubeThumbnailUrlByVideoId = (videoId) => {\n    dispatch('core/notices').createSuccessNotice(\n        'Found Youtube video thumbnail.',\n        {\n            id: 'videoThumbGetterSuccess',\n            isDismissible: true,\n        }\n    );\n    return `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;\n};\n\n/**\n * @param {string} videoId\n * @return {Promise<any>}\n */\nexport const getVimeoThumbnailUrlByVideoId = (videoId) => {\n    return fetch(`https://vimeo.com/api/v2/video/${videoId}.json`)\n        .then((response) => response.json())\n        .then((result) => result[0])\n        .then((result) => {\n            if (result && result['thumbnail_large']) {\n                dispatch('core/notices').createSuccessNotice(\n                    'Found Vimeo thumbnail.',\n                    {\n                        id: 'vimeoThumbGetterSuccess',\n                        isDismissible: true,\n                    }\n                );\n                return result['thumbnail_large'];\n            } else {\n                throw new Error('No matching thumbnail received');\n            }\n        })\n        .catch((err) => {\n            dispatch('core/notices').createWarningNotice(\n                'Fetching Vimeo thumbnail failed: ' + err,\n                {\n                    id: 'vimeoThumbGetterFailed',\n                    isDismissible: true,\n                }\n            );\n            return '';\n        });\n};\n"],"names":["dispatch","data","YT_LONG_REGEX","YT_SHORT_REGEX","YT_EMBED_REGEX","VIMEO_REGEX","VIMEO_EMBED_REGEX","IFRAME_REGEX","getYoutubeEmbedUrlFromVideoId","videoId","getVimeoEmbedUrlFromVideoId","isLongYoutubeUrl","videoUrl","match","isShortYoutubeUrl","isEmbedYoutubeUrl","isDefaultVimeoUrl","isEmbedVimeoUrl","isIframeString","isYoutubeUrl","isVimeoUrl","getYoutubeVideoIdFromUrl","isYT","isShortYT","isEmbedYT","getVimeoVideoIdFromUrl","isVimeo","isEmbedVimeo","getYoutubeEmbedByUrl","getVimeoEmbedByUrl","getVideoEmbed","isIframe","getYoutubeThumbnailUrlByVideoId","createSuccessNotice","id","isDismissible","getVimeoThumbnailUrlByVideoId","fetch","then","response","json","result","Error","err","createWarningNotice"],"mappings":"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"}